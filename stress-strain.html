<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Engineering Stress–Strain (Mild Carbon Steel)</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: #f3f4f6;
      color: #111827;
    }
    h1 { text-align: center; margin-bottom: 6px; }
    p  { text-align: center; color: #374151; margin-top: 0; }

    .plot-wrap {
      max-width: 1050px;
      margin: 0 auto 22px;
      background: white;
      border-radius: 14px;
      padding: 18px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }
    #curveMain, #curveZoom { width: 100%; height: 560px; }

    a {
      display: block;
      text-align: center;
      margin-top: 18px;
      color: #4f46e5;
      text-decoration: none;
    }
    a:hover { text-decoration: underline; }

    .hint {
      font-size: 13px;
      text-align: center;
      color: #6b7280;
      margin: 10px 0 0;
    }
  </style>
</head>

<body>
  <h1>Engineering Stress–Strain (Mild Carbon Steel)</h1>
  <p>Quiz yourself: hover over points/regions to reveal what they represent.</p>

  <div class="plot-wrap">
    <div id="curveMain"></div>
    <div class="hint">Tip: Hover over the markers/labels to see what each feature represents.</div>
  </div>

  <div class="plot-wrap">
    <div id="curveZoom"></div>
    <div class="hint">Zoomed view shows the 0.2% offset line and early-region properties more clearly.</div>
  </div>

  <a href="index.html">← Back to Home</a>

  <script>
    // -----------------------------
    // Material / teaching values (keep the "look" of your first file)
    // -----------------------------
    const E = 200000;      // MPa
    const sigma_y = 225;   // MPa
    const sigma_uts = 430; // MPa

    // Proportional limit / yield strain (same as your first file)
    const eps_prop = 0.0011;
    const sigma_prop = E * eps_prop;
    const eps_y = 0.003125;

    // Engineering stress–strain curve (same as your first file)
    const curve = [
      {x: 0.0,      y: 0},
      {x: eps_prop, y: sigma_prop},
      {x: eps_y,    y: sigma_y},
      {x: 0.010,    y: 255},
      {x: 0.030,    y: 310},
      {x: 0.070,    y: 380},
      {x: 0.120,    y: sigma_uts},
      {x: 0.180,    y: 410},
      {x: 0.250,    y: 340}
    ];

    // -----------------------------
    // 0.2% offset line (keep your first file behavior)
    // sigma = E*(eps - 0.002)
    // -----------------------------
    function offsetLine(e0, eEnd, step) {
      const xs = [], ys = [];
      for (let e = e0; e <= eEnd; e += step) {
        xs.push(e);
        ys.push(E * (e - 0.002));
      }
      return { xs, ys };
    }
    const offset = offsetLine(0.002, eps_y, 0.00005);

    // Key points
    const ptProp = { x: eps_prop, y: sigma_prop };
    const ptYield = { x: eps_y, y: sigma_y };
    const ptUTS = { x: 0.120, y: sigma_uts };
    const ptFrac = { x: 0.250, y: 340 };

    // -----------------------------
    // Detailed hover text (from your second file style)
    // -----------------------------
    const Ur = (sigma_y * sigma_y) / (2 * E); // MPa == MJ/m^3 numerically

    const hoverProp =
      `<b>Proportional Limit</b><br>` +
      `Highest stress where σ–ε is perfectly linear<br>` +
      `Approx here: ε ≈ <b>${eps_prop.toFixed(4)}</b> (in/in), ` +
      `σ ≈ <b>${Math.round(sigma_prop)} MPa</b>`;

    const hoverYield =
      `<b>Yield Strength</b><br>` +
      `Onset of permanent (plastic) deformation<br>` +
      `σ<sub>y</sub> ≈ <b>${sigma_y} MPa</b><br>` +
      `ε<sub>y</sub> ≈ <b>${eps_y.toFixed(5)}</b> (in/in)`;

    const hoverUTS =
      `<b>Ultimate Tensile Strength (UTS)</b><br>` +
      `Maximum <i>engineering</i> stress on the curve<br>` +
      `UTS ≈ <b>${sigma_uts} MPa</b><br>` +
      `<b>Necking begins at/just after UTS</b> (engineering curve peak)`;

    const hoverFrac =
      `<b>Fracture</b><br>` +
      `Final failure point after necking<br>` +
      `ε ≈ <b>${ptFrac.x.toFixed(3)}</b> (in/in), ` +
      `σ ≈ <b>${Math.round(ptFrac.y)} MPa</b>`;

    const hoverOffset =
      `<b>0.2% Offset Line</b><br>` +
      `Line with slope E, shifted by ε = 0.002<br>` +
      `Used to define “0.2% offset yield” consistently<br>` +
      `Equation: <b>σ = E(ε − 0.002)</b>`;

    const hoverResilience =
      `<b>Modulus of Resilience, U<sub>r</sub></b><br>` +
      `Elastic energy absorbed per unit volume up to yield<br>` +
      `Area under elastic region to σ<sub>y</sub><br>` +
      `<b>U<sub>r</sub> = σ<sub>y</sub><sup>2</sup> / (2E)</b><br>` +
      `U<sub>r</sub> ≈ <b>${Ur.toFixed(4)} MPa</b> (≈ ${Ur.toFixed(4)} MJ/m³)`;

    const hoverToughness =
      `<b>Tensile Toughness</b><br>` +
      `Total energy absorbed per unit volume to fracture<br>` +
      `Approx = area under the full engineering σ–ε curve`;

    const hoverElasticSlope =
      `<b>Elastic Modulus (E)</b><br>` +
      `Slope of the linear elastic region (Hooke’s law)<br>` +
      `<b>σ = E·ε</b><br>` +
      `E ≈ <b>200 GPa</b> (steel typical)`;

    // -----------------------------
    // Shaded Areas (keep first file "look")
    // -----------------------------
    // Tensile Toughness (full area)
    const toughnessTrace = {
      x: curve.map(p => p.x),
      y: curve.map(p => p.y),
      mode: 'lines',
      fill: 'tozeroy',
      fillcolor: 'rgba(59,130,246,0.15)',
      line: { width: 0 },
      hoverinfo: 'skip'
    };

    const toughnessLabel = {
      x: [0.12],
      y: [200],
      mode: 'markers',
      marker: { size: 12, color: 'rgba(59,130,246,0.6)' },
      text: [hoverToughness],
      hovertemplate: '%{text}<extra></extra>'
    };

    // Modulus of Resilience (elastic area)
    const resilienceCurve = curve.filter(p => p.x <= eps_y);

    const resilienceTrace = {
      x: resilienceCurve.map(p => p.x),
      y: resilienceCurve.map(p => p.y),
      mode: 'lines',
      fill: 'tozeroy',
      fillcolor: 'rgba(245,158,11,0.25)',
      line: { width: 0 },
      hoverinfo: 'skip'
    };

    const resilienceLabel = {
      x: [eps_y / 2],
      y: [sigma_y / 2],
      mode: 'markers',
      marker: { size: 12, color: 'rgba(245,158,11,0.8)' },
      text: [hoverResilience],
      hovertemplate: '%{text}<extra></extra>'
    };

    // -----------------------------
    // Fracture / Ductility line (keep first file "look")
    // -----------------------------
    const epsDuctility = ptFrac.x - ptFrac.y / E;

    const fractureSlopeTrace = {
      x: [epsDuctility, ptFrac.x],
      y: [0, ptFrac.y],
      mode: 'lines',
      line: { dash: 'dot', width: 2, color: 'purple' },
      hoverinfo: 'skip'
    };

    const fractureSlopeLabel = {
      x: [(epsDuctility + ptFrac.x) / 2],
      y: [ptFrac.y / 2],
      mode: 'markers',
      marker: { size: 10, color: 'purple' },
      text: ['<b>Ductility / strain to fracture (illustrative)</b><br>Projection shown with an E-slope line'],
      hovertemplate: '%{text}<extra></extra>'
    };

    const ductilityPointTrace = {
      x: [epsDuctility],
      y: [0],
      mode: 'markers',
      marker: { size: 10, color: 'purple' },
      text: [`<b>Ductility (illustrative)</b><br>ε ≈ <b>${epsDuctility.toFixed(3)}</b> (in/in)`],
      hovertemplate: '%{text}<extra></extra>'
    };

    // -----------------------------
    // Offset-line + elastic slope labels (keep first file "look", but richer text)
    // -----------------------------
    const epsOffsetMid = (0.002 + eps_y) / 2;
    const sigmaOffsetMid = E * (epsOffsetMid - 0.002);

    const offsetSlopeLabel = {
      x: [epsOffsetMid],
      y: [sigmaOffsetMid],
      mode: 'markers',
      marker: { size: 10, color: 'green' },
      text: [hoverOffset + '<br><br>' + hoverElasticSlope],
      hovertemplate: '%{text}<extra></extra>'
    };

    const propSlopeLabel = {
      x: [0.0007],
      y: [E * 0.0007],
      mode: 'markers',
      marker: { size: 10, color: 'red' },
      text: [hoverElasticSlope],
      hovertemplate: '%{text}<extra></extra>'
    };

    // -----------------------------
    // Main curve + offset line
    // -----------------------------
    const curveTrace = {
      x: curve.map(p => p.x),
      y: curve.map(p => p.y),
      mode: 'lines',
      line: { width: 4 },
      hoverinfo: 'skip'
    };

    const offsetTrace = {
      x: offset.xs,
      y: offset.ys,
      mode: 'lines',
      line: { dash: 'dash', width: 2, color: 'green' },
      hovertemplate: hoverOffset + '<extra></extra>'
    };

    // Key point markers (hover “quiz reveal”)
    const pointsTrace = {
      x: [ptProp.x, ptYield.x, ptUTS.x, ptFrac.x],
      y: [ptProp.y, ptYield.y, ptUTS.y, ptFrac.y],
      mode: 'markers',
      marker: { size: 10, color: 'red' },
      text: [hoverProp, hoverYield, hoverUTS, hoverFrac],
      hovertemplate: '%{text}<extra></extra>'
    };

    function layout(isZoom) {
      return {
        xaxis: { title: 'Strain, ε', range: isZoom ? [0, 0.01] : [0, 0.27] },
        // CHANGE REQUEST: zoom plot y-axis 0–300
        yaxis: { title: 'Stress, σ (MPa)', range: isZoom ? [0, 300] : [0, 500] },
        margin: { t: 30, l: 70, r: 20, b: 70 },
        showlegend: false
      };
    }

    // -----------------------------
    // Render: Full plot (keep first layout/stacking)
    // -----------------------------
    Plotly.newPlot(
      'curveMain',
      [
        resilienceTrace,
        toughnessTrace,
        curveTrace,
        offsetTrace,
        fractureSlopeTrace,
        resilienceLabel,
        toughnessLabel,
        fractureSlopeLabel,
        ductilityPointTrace,
        offsetSlopeLabel,
        propSlopeLabel,
        pointsTrace
      ],
      layout(false),
      { responsive: true }
    );

    // -----------------------------
    // Render: Zoom plot (requested y-range 0–300)
    // -----------------------------
    Plotly.newPlot(
      'curveZoom',
      [
        resilienceTrace,
        curveTrace,
        offsetTrace,
        fractureSlopeTrace,
        resilienceLabel,
        offsetSlopeLabel,
        propSlopeLabel,
        pointsTrace
      ],
      layout(true),
      { responsive: true }
    );
  </script>
</body>
</html>
